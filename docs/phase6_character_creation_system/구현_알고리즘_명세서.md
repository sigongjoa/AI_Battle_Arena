# Phase 6: 캐릭터 생성 시스템 구현 알고리즘 명세서

## 1. 개요

본 문서는 '캐릭터 생성 시스템'의 핵심 알고리즘 및 의사 코드(Pseudo-code)를 정의한다. 광고 콘텐츠 분석부터 캐릭터 속성 및 스킬 생성에 이르는 과정을 상세화한다.

## 2. 광고 텍스트 분석 알고리즘

### 2.1. `extractCharacterTheme(adText: string): { theme: string, attributes: string[] }`
*   **목적**: 광고 텍스트에서 캐릭터 테마와 관련 속성을 추출한다.
*   **의사 코드**:
    ```
    FUNCTION extractCharacterTheme(adText as string):
        adTextLower = adText.toLowerCase()
        themeKeywords = {
            "레이싱": {"theme": "racing", "attributes": ["speed", "agility"]},
            "건설": {"theme": "construction", "attributes": ["strength", "durability"]},
            // ... 기타 정의된 키워드 매핑 ...
        }

        FOR keyword, data IN themeKeywords:
            IF keyword.toLowerCase() IN adTextLower THEN
                RETURN data
            END IF
        END FOR
        
        // 정의되지 않은 테마 처리: 'general' 테마 반환
        RETURN {"theme": "general", "attributes": ["balance"]}
    END FUNCTION
    ```

## 3. 캐릭터 속성 및 스킬 생성 알고리즘

### 3.1. `generateCharacterData(theme: string, attributes: string[]): CharacterData`
*   **목적**: 추출된 테마와 속성을 기반으로 캐릭터의 외형, 스킬, 파라미터를 생성한다.
*   **의사 코드**:
    ```
    FUNCTION generateCharacterData(theme as string, attributes as string[]):
        characterData = {}
        characterData.id = "char_" + RANDOM_INT(10000, 99999)
        characterData.theme = theme

        // 외형 생성 (테마-에셋 매핑 테이블 기반)
        themeAssetMap = { "racing": { "appearance_parts": ["racing_helmet", ...], "skills": [...] }, ... }
        parts = themeAssetMap.get(theme, themeAssetMap["general"]).appearance_parts
        characterData.appearance = {
            modelId: "base_model",
            textureId: theme,
            colorScheme: [RANDOM_COLOR(), RANDOM_COLOR()],
            parts: RANDOM_SAMPLE(parts, MIN(LENGTH(parts), 2))
        }

        // 스킬 생성
        skillsList = themeAssetMap.get(theme, themeAssetMap["general"]).skills
        characterData.skills = []
        FOR skillName IN skillsList:
            characterData.skills.add({ name: skillName, effect: skillName + "_effect", animationId: skillName + "_anim" })
        END FOR

        // 파라미터 생성 및 밸런싱 (총 능력치 분배)
        totalStatPoints = 300
        params = { health: 0, attackPower: 0, defense: 0, speed: 0 }
        attributeWeights = { "speed": 1.5, "strength": 1.5, ... }
        weightedDistribution = { health: 0.3, attackPower: 0.25, ... }

        FOR attr IN attributes:
            IF attr IN attributeWeights:
                // 속성에 따라 weightedDistribution 조정 (예: speed 속성은 speed 파라미터 가중치 증가)
            END IF
        END FOR
        
        // 정규화 및 총 능력치 분배
        // 최소값 보장 (예: 각 파라미터 최소 10점)
        characterData.parameters = CALCULATE_DISTRIBUTED_PARAMETERS(totalStatPoints, weightedDistribution)

        RETURN characterData
    END FUNCTION
    ```

## 4. 게임 엔진 통합 알고리즘

### 4.1. `loadGeneratedCharacter(characterData: CharacterData, targetPlayerId: string): void`
*   **목적**: 생성된 캐릭터 데이터를 게임 엔진에 로드하여 플레이 가능한 캐릭터 객체로 변환한다.
*   **의사 코드**:
    ```
    FUNCTION loadGeneratedCharacter(characterData as CharacterData, targetPlayerId as string):
        playerToUpdate = GET_PLAYER_BY_ID(targetPlayerId) // 게임 상태에서 해당 플레이어 객체 가져오기

        playerToUpdate.id = characterData.id // 생성된 ID로 업데이트
        playerToUpdate.health = FixedPoint.fromInt(characterData.parameters.health)
        // 현재는 체력만 업데이트. 공격력, 방어력, 속도, 스킬 등은 게임 로직 통합 필요
        playerToUpdate.action = 'idle' // 액션 초기화
        // 외형 데이터(appearance)는 렌더링 로직에서 사용될 예정

        LOG("Loaded generated character " + characterData.theme + " for player " + targetPlayerId)
    END FUNCTION
    ```
