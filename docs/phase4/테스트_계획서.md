# Phase 4: 테스트 계획서

이 문서는 Phase 4에서 구현된 핵심 기능(gRPC 실시간 동기화)의 안정성을 검증하고, 전체 시스템이 의도대로 동작하는지 확인하기 위한 테스트 계획을 정의합니다.

---

## 1. 테스트 목표 및 전략

- **테스트 목표:** 백엔드-프론트엔드 간 gRPC 통신을 통한 실시간 게임 상태 동기화 기능이 안정적으로 동작함을 검증하고, 주요 기능의 통합 테스트를 통해 시스템의 전반적인 안정성을 확보하는 것을 목표로 합니다.

- **테스트 전략:**
    1.  **통합 테스트 (Integration Test):** 개별 컴포넌트(프론트엔드, 프록시, 백엔드)가 서로 원활하게 연동되는지에 초점을 맞춥니다.
    2.  **엔드-투-엔드 테스트 (End-to-End Test):** 사용자의 실제 시나리오를 기반으로 전체 시스템의 흐름을 처음부터 끝까지 수동으로 테스트하여 최종 결과물의 완성도를 검증합니다. 본 계획서는 E2E 테스트를 중심으로 기술합니다.

---

## 2. 테스트 환경 설정

- **목표:** 일관된 환경에서 전체 애플리케이션을 실행하고 테스트를 진행할 수 있는 환경을 구축합니다.

- **사전 요구사항:**
    - Python 3.10 이상
    - Node.js 18 이상 및 npm
    - Envoy Proxy 설치 완료

- **환경 설정 절차:**
    1.  **Python 의존성 설치:** 프로젝트 루트 디렉토리에서 실행합니다.
        ```bash
        # 1. 기존 의존성 설치
        pip install -r backend/requirements.txt
        
        # 2. gRPC 버전 호환성을 위해 최신 버전으로 업그레이드
        pip install --upgrade grpcio grpcio-tools
        ```

    2.  **Frontend 의존성 설치:** `arcade-clash` 디렉토리에서 실행합니다.
        ```bash
        cd arcade-clash
        npm install
        ```

- **테스트 환경 실행:**
    - **총 3개의 터미널**이 필요하며, 각각 아래의 명령어를 실행합니다.

    - **터미널 1: 백엔드 서버 실행**
        ```bash
        python -m uvicorn backend.main:app --host 0.0.0.0 --port 8000
        ```

    - **터미널 2: Envoy 프록시 실행**
        ```bash
        envoy -c envoy.yaml
        ```

    - **터미널 3: 프론트엔드 개발 서버 실행**
        ```bash
        cd arcade-clash
        npm run dev
        ```

- **접속 정보:**
    - 위 3개의 프로세스가 모두 실행 중인 상태에서, 웹 브라우저를 열고 아래 주소로 접속합니다.
    - **URL:** `http://localhost:3000` (또는 Vite가 지정한 다른 포트)

---

## 3. 테스트 시나리오 및 진행 방향

### 시나리오 1: 실시간 게임 상태 동기화 E2E 테스트

- **목표:** 백엔드에서 스트리밍되는 게임 상태가 프론트엔드에 정확하게 렌더링되는지 검증합니다.
- **테스트 절차:**
    1.  테스트 환경 실행 후, 브라우저로 프론트엔드 URL(`http://localhost:3000`)에 접속합니다.
    2.  메인 메뉴 화면이 정상적으로 표시되는지 확인합니다.
    3.  화면의 버튼을 클릭하여 `Character Select` -> `VS Screen`을 거쳐 게임 시작 화면(`HUD`)으로 진입합니다.
    4.  **[검증 포인트 1: 초기 상태]**
        - 타이머가 `99`에서 시작하는가?
        - 양쪽 플레이어의 체력 바가 `100%`로 가득 차 있는가?
        - **캐릭터를 의미하는 붉은색 사각형 2개가 화면의 초기 위치에 나타나는가?**
    5.  **[검증 포인트 2: 실시간 업데이트]**
        - 약 30초간 화면을 관찰합니다.
        - 시간이 지남에 따라 타이머 숫자가 감소하는가?
        - **붉은색 사각형들이 화면을 움직이는가? (백엔드의 좌표 값 변경이 반영되는지)**
        - AI 간의 전투 시뮬레이션에 따라 양쪽 플레이어의 체력 바가 감소하는가?
    6.  **[검증 포인트 3: 경기 종료]**
        - 한쪽 플레이어의 체력이 0이 되거나 타이머가 0이 될 때까지 기다립니다.
        - 경기 종료 후, `Match Results`(경기 결과) 화면으로 자동으로 전환되는가?
        - 해당 화면에 올바른 승리자 정보가 표시되는가?

---

## 4. 성공 및 실패 판단 기준

- **성공 기준 (아래 조건을 모두 만족해야 함):**
    1.  백엔드, 프록시, 프론트엔드 3개의 서비스가 각 터미널에서 심각한 오류 없이 시작된다.
    2.  브라우저에서 프론트엔드 애플리케이션이 콘솔 에러 없이 로드된다.
    3.  `시나리오 1`의 모든 테스트 절차를 막힘없이 수행할 수 있다.
    4.  `시나리오 1`의 모든 **검증 포인트**에서 기대 결과가 실제 결과와 일치한다.
    5.  테스트 진행 중 gRPC 연결이 예기치 않게 끊기거나, 브라우저 개발자 콘솔에 관련 에러가 발생하지 않는다.

- **실패 기준:**
    - 위 성공 기준 중 하나라도 만족하지 못하는 경우.
    - 특정 서비스가 실행에 실패하거나, 테스트 도중 애플리케이션이 멈추거나 응답하지 않는 경우.
    - 캐릭터(붉은 사각형)가 아예 나타나지 않거나, 나타나도 움직이지 않는 등 실시간 업데이트가 전혀 이루어지지 않는 경우.
