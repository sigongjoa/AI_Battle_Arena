# Phase 4 테스트 계획 및 성공 기준

## 1. 개요
이 문서는 'WebRTC 기반 강화학습 환경' 구축의 품질을 보증하기 위한 테스트 계획과, 개발의 완료 및 성공을 판단하는 기준을 정의한다. 모든 테스트는 `phase4/기술_명세서.md`에 정의된 기능과 아키텍처를 기반으로 한다.

---

## 2. 테스트 환경 및 사전 조건

- **테스트 환경**: E2E 테스트는 로컬 환경에서 2개의 서버를 모두 실행한 상태에서 진행한다.
- **사전 조건**:
    1.  **메인 백엔드 서버 (FastAPI + Signaling)**: `python backend/main.py` 명령으로 실행되어야 한다.
    2.  **프론트엔드 개발 서버 (Vite)**: `cd arcade-clash && npm run dev` 명령으로 실행되어야 한다.

---

## 3. 테스트 유형 및 절차

### 2.1. 단위 테스트 (Unit Tests)
-   **목표**: 각 모듈이 독립적으로 정확하게 동작하는지 검증한다.
-   **대상**:
    -   **`WebRTCClient`**: 메시지 직렬화/역직렬화 로직, 큐(Queue)를 이용한 데이터 송수신 로직을 테스트한다.
    -   **`FightingEnv`**: `step`, `reset` 메서드가 큐에 올바른 형식의 메시지를 넣고, 큐로부터 받은 응답을 Gym 표준에 맞는 데이터 타입으로 정확히 파싱하는지 테스트한다. (WebRTC 연결 자체는 모킹)

### 2.2. 통합 테스트 (Integration Tests)
-   **목표**: 백엔드와 프론트엔드가 WebRTC를 통해 실제로 연동되어 동작하는지 검증한다.
-   **시나리오 1: '핑퐁(Ping-Pong)' 테스트**
    1.  백엔드에서 "ping" 메시지를 프론트엔드로 전송한다.
    2.  프론트엔드는 "ping"을 수신하면 즉시 "pong" 메시지를 백엔드로 응답한다.
    3.  백엔드가 "pong"을 성공적으로 수신하는지 확인하여, 데이터 채널의 기본적인 양방향 통신을 검증한다.
-   **시나리오 2: `RandomAgent` 테스트**
    1.  실제 RL 에이전트 대신, 매 스텝 무작위 행동(Random Action)을 생성하는 간단한 `RandomAgent`를 백엔드에서 실행한다.
    2.  `reset` -> `step` -> ... -> `done`으로 이어지는 전체 사이클이 네트워크를 통해 정상적으로 끝까지 동작하는지 엔드투엔드로 확인한다.
    3.  이 테스트는 전체 시스템의 파이프라인이 올바르게 연결되었음을 보장한다.

### 2.3. 학습 검증 테스트
-   **목표**: 실제 강화학습이 진행되고, 모델의 성능이 개선되는지를 확인한다.
-   **절차**:
    1.  `train_rl_agent.py`를 실행하여 단기 학습(예: 10,000 타임스텝)을 진행한다.
    2.  `TensorBoard`를 실행하여 로그를 확인한다.
-   **검증 항목**:
    -   학습 과정에서 에러가 발생하지 않는가?
    -   TensorBoard에 표시되는 **평균 보상(Mean Reward) 그래프가 전반적으로 우상향**하는 경향을 보이는가?

---

## 3. 성공 판단 기준

`Phase 4: WebRTC 기반 강화학습 환경 구축`의 최종 성공은 아래 기준을 모두 만족하는 것으로 판단한다.

1.  **[ ] 단위/통합 테스트 통과**: 위 2.1절과 2.2절에서 정의된 모든 단위 테스트와 통합 테스트 시나리오를 100% 통과해야 한다.

2.  **[ ] `RandomAgent` 사이클 완료**: `RandomAgent` 테스트 시, 최소 10번 이상의 에피소드가 에러 없이 정상적으로 완료되어야 한다.

3.  **[ ] 기본 학습 검증**: 단기 학습 실행 시, 평균 보상 그래프가 눈에 띄는 학습 경향(상승)을 보여야 한다. 이는 시스템이 보상 신호를 통해 유의미한 학습을 하고 있음을 증명한다.

4.  **[ ] 코드 리뷰 및 머지**: Phase 4 구현과 관련된 모든 코드는 코드 리뷰를 통과하고 `main` 브랜치에 성공적으로 머지되어야 한다.
