# Phase 4: 통합 검증 및 기능 구현 계획서

지금까지 여러 에러를 해결하며 진행한 결과, 이제 안정적인 기술 토대를 마련했습니다. 현재까지의 진행 상황을 명확히 정리하고, 앞으로 나아갈 방향을 구체적으로 제시합니다.

---

## 1. 현재까지의 진행 상황 (어디까지 왔나?)

현재 우리는 **"백엔드 서버에서 실시간으로 보내주는 게임 데이터를 프론트엔드에서 받아 캐릭터를 화면에 그리기"** 위한 핵심적인 기술 토대를 모두 마련했습니다. 비유하자면, 건물을 짓기 위한 상하수도, 전기, 가스 배관 공사를 모두 마친 상태입니다.

### 완료된 핵심 작업:

- **데이터 설계 (`.proto`):** 캐릭터의 위치, 체력, 행동 등 상세한 정보를 담을 수 있도록 `PlayerState`와 `GameState` 데이터 구조를 새롭게 정의했습니다.
- **백엔드 구현 (`Python`):**
    - 새로운 데이터 구조에 맞춰 게임(`GameRunner`)이 실시간으로 `GameState` 데이터를 생성하고 gRPC 스트림으로 전송하도록 수정했습니다.
    - 실행 과정에서 발생했던 Python의 모듈 임포트 에러, gRPC 버전 충돌 문제 등을 모두 해결했습니다.
- **프론트엔드 구현 (`React`):**
    - 백엔드에서 보낸 `GameState`를 실시간으로 수신하여 화면을 업데이트하도록 `HUD.tsx`와 `TrainingMode.tsx` 컴포넌트를 최신 gRPC 클라이언트(`nice-grpc-web`) 방식으로 리팩토링했습니다.
    - 수신한 데이터에 따라 캐릭터를 화면에 그릴 `Character.tsx` 컴포넌트의 뼈대를 만들었습니다.
    - 빌드 과정에서 발생했던 TypeScript 임포트 경로 문제, gRPC 코드 생성 오류 등을 모두 해결했습니다.

**결론:** 현재 우리 시스템은 **기술적으로 완전한 실행 준비 상태**입니다. 백엔드, 프론트엔드, 그리고 둘을 이어주는 gRPC 통신 계층까지 모든 코드의 수정 및 디버깅이 완료되었습니다.

---

## 2. 앞으로의 진행 방향 (무엇을 해야 하나?)

이제부터는 명확한 목표를 가지고 기능을 하나씩 완성해 나갈 차례입니다.

### 1단계: 전체 시스템 연동 검증 (가장 먼저 할 일)

- **목표:** 지금까지 작업한 백엔드-프론트엔드 전체 시스템이 의도대로 완벽하게 동작하는지 최종 확인합니다.
- **실행 방법:**
    1. **백엔드 서버 실행:** `python -m uvicorn backend.main:app --reload`
    2. **Envoy 프록시 실행:** `envoy -c envoy.yaml`
    3. **프론트엔드 서버 실행:** `npm run dev`
- **예상 결과:** 브라우저에서 게임을 시작하면, **캐릭터를 의미하는 붉은색 사각형 두 개가 화면에 나타나고, 백엔드에서 보내주는 데이터에 따라 실시간으로 움직여야 합니다.** 타이머와 체력 바 역시 연동되어야 합니다. 이 단계가 성공하면, 우리는 안정적인 기반을 확보한 것입니다.

### 2단계: 캐릭터 스프라이트 구현

- **목표:** 현재 보이는 붉은색 사각형을 실제 캐릭터 이미지(스프라이트)로 교체하고, 행동에 맞는 애니메이션을 구현합니다.
- **주요 작업 (프론트엔드):**
    1. `public/assets` 폴더에 캐릭터 스프라이트 이미지 파일(예: `ryu.png`)을 추가합니다.
    2. `Character.tsx` 컴포넌트를 수정하여, 서버에서 받은 `action` (행동)과 `frame` (프레임) 값에 따라 스프라이트 이미지의 정확한 부분을 잘라내어 보여주도록 구현합니다. (CSS `background-position` 속성 활용)

### 3단계: 플레이어 조작 구현

- **목표:** 유저가 키보드로 직접 한쪽 플레이어를 조작할 수 있게 합니다.
- **주요 작업 (프론트엔드 + 백엔드):**
    1. **프론트엔드:** 키보드 입력(방향키, 공격키 등)을 감지하여 gRPC를 통해 백엔드로 전송합니다.
    2. **백엔드:** `GameRunner`가 이 입력을 받아 게임 환경에 적용하고, 해당 플레이어의 상태를 업데이트하도록 수정합니다. (현재는 양쪽 모두 AI가 조작)

### 4단계: 게임플레이 로직 고도화

- **목표:** 실제 격투 게임처럼 만들고 AI를 강화합니다.
- **주요 작업 (백엔드):**
    - 캐릭터 간의 충돌 감지 로직을 구현합니다.
    - 공격이 성공했을 때 체력이 감소하는 로직을 구현합니다.
    - 필살기 게이지와 같은 시스템을 추가합니다.
