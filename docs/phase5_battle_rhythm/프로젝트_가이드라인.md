# AI Battle Arena 프로젝트 가이드라인

## 1. 개요
이 문서는 AI Battle Arena 프로젝트의 모든 참여자가 일관되고 효율적으로 협업하기 위한 핵심 규칙과 문화를 정의한다. 이 가이드라인의 목적은 코드의 품질을 높이고, 가독성을 확보하며, 잠재적인 오류를 사전에 방지하고, 신규 참여자가 빠르게 프로젝트에 적응할 수 있도록 돕는 것이다.

---

## 2. 파일 및 폴더 구조
프로젝트의 모든 파일은 명확하게 정의된 구조를 따라야 한다.

- **`/` (Root)**
    - **`arcade-clash/`**: Frontend (React/TypeScript) 관련 모든 소스 코드 및 설정.
    - **`backend/`**: Backend 서버 (Python, FastAPI) 관련 소스 코드.
    - **`src/`**: 핵심 게임 로직 및 강화학습 환경 (Python) 소스 코드. **`backend`와 `arcade-clash` 양쪽에서 참조될 수 있는 공유 라이브러리 역할을 한다.**
    - **`docs/`**: 모든 기획, 명세, 가이드라인 문서. `phaseX_...` 형태로 하위 폴더를 구성한다.
    - **`tests/`**: 모든 테스트 코드. 내부 구조는 `src`, `backend`의 구조를 미러링한다.
    - **`models/`**: 학습된 AI 모델 파일.
    - **`data/`**: 학습이나 테스트에 사용되는 데이터셋.

---

## 3. 경로 별칭 및 Import 정책

**모든 `import` 오류의 근원은 모호한 경로 지정이다. 이 문제를 해결하기 위해 다음 규칙을 강제한다.**

### 3.1. Python (`backend/`, `src/`)
- **규칙**: 모든 `import`는 프로젝트의 최상위 루트(`/mnt/d/progress/AI_Battle_Arena`)에서 시작하는 **절대 경로(Absolute Path)**를 사용한다.
- **근거**: `.`이나 `..`을 사용하는 상대 경로는 파일 위치가 변경될 때 쉽게 깨지며, 코드의 의존성을 파악하기 어렵게 만든다. 절대 경로는 이 문제를 원천적으로 해결한다.
- **좋은 예** (`backend/core/game_runner.py`에서 `src/fighting_env.py`를 임포트할 경우):
  ```python
  from src.fighting_env import FightingEnv # GOOD
  ```
- **나쁜 예**:
  ```python
  from ...src.fighting_env import FightingEnv # BAD: Do NOT use relative paths across modules.
  ```

### 3.2. TypeScript/React (`arcade-clash/`)
- **규칙**: `tsconfig.json`에 정의된 **경로 별칭(Path Alias)**을 사용한다.
- **근거**: `../../../../` 와 같은 상대 경로 지옥(Hell)을 방지하고, 마치 라이브러리를 임포트하는 것처럼 명확하고 간결하게 경로를 표현할 수 있다.
- **설정 (`arcade-clash/tsconfig.json`)**:
  ```json
  {
    "compilerOptions": {
      "baseUrl": ".",
      "paths": {
        "@/*": ["src/*"]
      }
    }
  }
  ```
- **좋은 예**:
  ```typescript
  import { HUD } from '@/components/HUD'; // GOOD
  ```
- **나쁜 예**:
  ```typescript
  import { HUD } from '../HUD'; // BAD: Avoid relative paths for top-level directories.
  ```

---

## 4. 코딩 컨벤션 및 스타일 가이드
모든 코드는 한 사람이 작성한 것처럼 일관성을 유지해야 한다.

- **Python**: **`Black` (포맷팅), `isort` (임포트 정렬), `Flake8` (린팅)** 사용을 강제한다. `pyproject.toml`에 설정을 통합하여 관리한다. IDE에서 저장 시 자동으로 적용되도록 설정한다.
- **TypeScript/React**: **`ESLint` (린팅)와 `Prettier` (포맷팅)** 사용을 강제한다. `.eslintrc.json`, `.prettierrc` 설정 파일을 통해 규칙을 공유하며, 저장 시 자동 포맷팅을 활성화한다.

---

## 5. 브랜칭 및 커밋 메시지 전략

### 5.1. 브랜칭 전략 (GitHub Flow 기반)
- **`main`**: 항상 배포 가능한 상태를 유지하는 프로덕션 브랜치.
- **`feat/<feature-name>`**: 신규 기능 개발 브랜치. (예: `feat/rhythm-analyzer`)
- **`fix/<bug-name>`**: 버그 수정 브랜치. (예: `fix/player-collision-bug`)
- **`docs/<document-name>`**: 문서 추가 및 수정 브랜치.
- 모든 작업은 `main`에서 분기한 브랜치에서 진행하며, 작업 완료 후 Pull Request(PR)를 통해 `main`으로 머지한다.

### 5.2. 커밋 메시지 규칙 (Conventional Commits)
- **형식**: `<type>(<scope>): <subject>`
- **`<type>` 종류**:
    - `feat`: 새로운 기능 추가
    - `fix`: 버그 수정
    - `docs`: 문서 변경
    - `style`: 코드 스타일 변경 (포맷팅, 세미콜론 등)
    - `refactor`: 기능 변경 없는 코드 리팩토링
    - `test`: 테스트 코드 추가/수정
    - `chore`: 빌드, 패키지 매니저 설정 등 기타 잡일
- **예시**: `feat(analyzer): Add rhythm entropy calculation logic`

---

## 6. 로깅 및 에러 핸들링 정책
로그는 시스템의 유일한 '블랙박스'이다. 다음 정책에 따라 로그를 기록한다.

- **`DEBUG`**: 개발 단계에서만 필요한 상세 정보. (예: `WebRTC 메시지 송수신 내용`, `함수 진입/탈출`, `변수 값`)
- **`INFO`**: 시스템의 주요 상태 변경 및 핵심 동작 정보. (예: `서버 시작`, `AI 모델 로딩 완료`, `WebRTC 연결 성공`)
- **`WARN`**: 예상치 못한 상황이지만, 시스템 동작은 계속되는 경우. (예: `메시지 응답 지연`, `설정 파일의 일부 값 누락`)
- **`ERROR`**: 즉시 조치가 필요한 심각한 오류. 예외(Exception) 발생 시 반드시 `stack trace`와 함께 기록한다.

---

## 7. 완료의 정의 (Definition of Done, DoD)
하나의 기능 또는 태스크는 다음 기준을 모두 만족했을 때 '완료'된 것으로 간주한다.

1.  [ ] 요구사항에 맞는 코드가 모두 작성되었는가?
2.  [ ] 관련된 단위 테스트 및 통합 테스트 코드를 작성하고, 모든 테스트를 통과했는가?
3.  [ ] 코딩 컨벤션 및 스타일 가이드를 100% 준수했는가? (Linter/Formatter 통과)
4.  [ ] 코드 변경으로 인해 영향을 받는 모든 관련 문서(기획, 명세 등)가 최신화되었는가?
5.  [ ] 동료의 코드 리뷰(Code Review)를 받고 승인(Approve)을 받았는가?
6.  [ ] `main` 브랜치에 성공적으로 머지(Merge)되었는가?
